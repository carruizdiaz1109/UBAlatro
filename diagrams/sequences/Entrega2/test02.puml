@startuml
'https://plantuml.com/sequence-diagram

title Se verifica que se aplica comodin puntaje correctamente

actor ":TestCase" as user
participant ":Ronda" as ronda
participant ":CartaPoker" as carta
participant "cartas :ArrayList" as lista
participant ":Mazo" as mazo
participant ":Mano" as mano
participant ":Jugador" as jugador
participant "unComodin :EfectoPuntaje" as comodin
participant "unaJugada: Poker" as jugada
user -> mazo**: Mazo()
user -> ronda**: Ronda(numero: 1, puntajeMinimo: 10000, descartesDisponibles: 3, jugadasDisponibles: 3)
user -> lista**: ArrayList()

loop por 5 cartas
user -> carta**: CartaPoker(Valor, Palo)
user -> lista: add(carta)
end

user -> mano**: Mano(cartas)

user -> jugador**: Jugador(Pepe, mazo)
user -> jugador: iniciarRonda(ronda)
    jugador -> mano: rellenarse()
        loop !manoLlena() && mazo.tieneCartas()
            mano -> mazo: darCarta()
            mazo --> mano: unaCarta
            mano -> mano: agregarCarta(unaCarta)
        end

user -> jugada**: crearJugada(cartas)
jugada --> user: unaJugada

user -> user: puntajeEsperado = (2*4+60)*7*8

user -> comodin**: EfectoPuntaje(valor: 0, multiplicador: 8)

loop por 5 cartas
user -> jugador: seleccionarCarta(carta)
jugador -> mano: seleccionarCarta(carta)
end

user -> jugador: anadirComodin(unComodin)
user -> jugador: jugar()
    jugador -> mano: jugar()
    mano --> jugador: unaJugada
    jugador -> jugador: aplicarComodin(unaJugada)
    jugador -> comodin: aplicar(unaJugada)
    comodin -> jugada: aplicarComodin(puntaje)
    jugada -> puntaje: sumarPuntaje(puntaje)
    puntaje --> jugada: unPuntaje
user -> ronda: calcularTotalRonda()
loop for each jugada in jugadas
    ronda -> jugada: calcularPuntaje()
        jugada -> puntaje: calcularPuntaje()
        puntaje --> jugada: unPuntaje
    jugada --> ronda: unPuntaje
end
ronda --> user: puntajeObtenido

user -> user: assertEquals(puntajeEsperado, puntajeObtenido);

@enduml